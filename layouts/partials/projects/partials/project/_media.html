{{ $image := .image }}
{{ $type := "projects" }}
{{ $layout := .layout | default "item" }}
{{ $sizes := .sizes }}
{{ $class := "media" }}
{{ with .class }}
  {{ $class = printf "%s %s" $class . }}
{{ end }}

{{ if not $sizes }}
  {{ $sizes = partial "GetSiteParamWithDefault" (dict 
    "param" (printf "image_sizes.sections.%s.%s" $type $layout)
    "default" "image_sizes.design_system.item"
  ) }}
{{ end }}

{{ if eq $layout "grid" }}
  {{ $sizes = site.Params.image_sizes.sections.projects.layouts.grid }}
{{ end }}

<div class="{{ $class }}">
  {{- if $image -}}
    {{- partial "commons/image.html" (dict
        "image" $image
        "sizes" $sizes
        "crop" true
      ) -}}
  {{- else -}}
    {{- partial "commons/image-default.html" $type -}}
  {{- end -}}
</div>