// home
.page__home
    .hero
        .content
            hgroup
                h1
                    @extend .sr-only
                &.has-lead > p
                    @include h1
                    text-align: center
    @include media-breakpoint-up(desktop)
        &.full-width
            main > .document-content .blocks
                --block-space-y: #{space(34)}
        main
            background-size: 100% 65vh
    
// projects
.page__home .block-projects
    &--grid
        .project
            .project-content
                align-items: center
                background-color: $color-background-brown
                display: flex
                flex-direction: column
                gap: $spacing-1
                justify-content: center
                text-align: center
                padding: $spacing-3
                transition: opacity 0.3s ease
                z-index: 2
                .project-description
                    flex: unset
                .project-title
                    @include h4
                .project-subtitle
                    @include body-text
                .project-subtitle,
                .project-meta time
                    color: var(--color-text)
                    font-weight: 400
                .project-meta
                    order: -1
            .media
                margin-bottom: 0
                z-index: 1
                img
                    aspect-ratio: 638/468
                    object-fit: cover
            // TODO: remove 'has' when everything is online or decide of a default image
            &:has(.media:empty)
                .project-content
                    aspect-ratio: 638/468
            &:has(.media:not(:empty))
                .project-content
                    bottom: 0
                    left: 0
                    opacity: 0
                    position: absolute
                    top: 0
                    right: 0
            &:hover .project-content
                opacity: 1 !important
        @include media-breakpoint-down(desktop)
            .media
                margin-left: 0
                margin-right: 0
        @include media-breakpoint-up(desktop)
            .block-content
                display: flex
                align-items: center
                justify-content: center
            .grid
                max-width: calc(#{columns(10)} + #{pxToRem(110)})
                padding-top: pxToRem(230)
                margin: auto
                display: flex
                flex-direction: row-reverse
                flex-wrap: wrap
                justify-content: end
                align-items: start
                gap: pxToRem(110)
                .project
                    width: columns(5)
                    &:nth-child(odd)
                        margin-top: pxToRem(-230)

// projects
.projects__section,
.projects__page,
.projects_categories__term
    .taxonomies-list--inline
        @include grid(1)
    .taxonomy-categories
        justify-content: center
    .hero .projects-categories,
    .taxonomy-categories,
    .taxonomies-single
        @include list-reset
        display: flex
        flex-wrap: wrap
        gap: $spacing-2 space()
        @include media-breakpoint-up(desktop)
            gap: $spacing-1 $spacing-2
        li a
            @extend .btn
            @extend .button--small
            @extend .button--accent
            background: none
            line-height: 1
            min-width: unset
    @include media-breakpoint-down(desktop)
        .hero .projects-categories,
        .taxonomy-categories
            align-items: center
            flex-direction: column
            margin-left: auto
            margin-right: auto

.projects__section
    .hero
        padding-bottom: 0
        margin-bottom: $spacing-2
    .taxonomies-list--inline
        max-width: columns(10)
        margin-left: auto
        margin-right: auto
        &, > div ul
            align-items: baseline
            display: flex
            flex-wrap: wrap
            gap: space(3)
            justify-content: center
            @include media-breakpoint-down(desktop)
                flex-direction: column
                align-items: center
    .table-responsive
        margin-right: 0
        padding-right: 0
        table.projects-list
            border-bottom: 1px dashed var(--color-text-alt)
            th, td:not(.project-title)
                @include meta
            a
                text-decoration: none
                line-height: 1
            thead
                color: var(--color-text-alt)
                @include media-breakpoint-down(desktop)
                    border: 0 !important
                    clip: rect(1px,1px,1px,1px) !important
                    clip-path: inset(50%) !important
                    height: 1px !important
                    overflow: hidden !important
                    padding: 0 !important
                    margin: 0 !important
                    position: absolute !important
                    width: 1px !important
                    white-space: nowrap !important
                th
                    font-weight: 300
            tr
                position: relative
                td:first-of-type
                    @include h6
                    a
                        @include stretched-link
                    @include media-breakpoint-up(desktop)
                        @include h4
                    @supports (background: -webkit-named-image(i))
                        position: relative
                    @include media-breakpoint-down(desktop)
                        border-top-style: dashed
                        border-top-width: 1px
                        border-color: var(--color-text-alt)
                // columsn width and spacings
                td:not(:last-of-type)
                    padding-right: 0
                    width: calc(#{columns(2)} + var(--grid-gutter))
                th:first-of-type,
                td:first-of-type
                    padding-left: var(--grid-gutter)
                    min-width: 45vw
                    @include media-breakpoint-up(desktop)
                        width: calc(#{columns(5)} + var(--grid-gutter))
                th:last-of-type,
                td:last-of-type
                    padding-right: var(--grid-gutter)
                    text-align: right
                td + td,
                th + th
                    padding-left: var(--grid-gutter)
                td
                    border-top-style: dashed
                    border-top-width: 1px
                    border-color: var(--color-text-alt)
                    @include media-breakpoint-down(desktop)
                        display: flex
                        line-height: 1 !important
                        flex-direction: column
                        align-items: start
                        width: 100% !important
                        border: none
                        &:not(:first-child)
                            padding-top: space(2)
                        &:not(:last-child)
                            padding-bottom: space(2)
                        &.mobile-hidden
                            border: 0 !important
                            clip: rect(1px,1px,1px,1px) !important
                            clip-path: inset(50%) !important
                            height: 1px !important
                            overflow: hidden !important
                            padding: 0 !important
                            margin: 0 !important
                            position: absolute !important
                            width: 1px !important
                            white-space: nowrap !important

        // hover effect
        tbody
            td:not(.project-title)
                a
                    position: relative
                    z-index: 2
                    text-decoration-color: $color-background
                    &:hover
                        @include link(inherit)
            tr
                &:first-of-type td
                    border-color: var(--color-text)
                &:hover
                    background: var(--color-accent)
                    td, a
                        color: var(--color-background)
                    &, + tr
                        td
                            border-color: var(--color-accent)
    @include media-breakpoint-down(desktop)
        .table-responsive
            margin-right: 0
            padding-right: 0

.projects__page
    .hero
        .hero-text
            padding-bottom: 0
            h1
                width: columns(7)
                @include media-breakpoint-down(desktop)
                    width: 100%
                span
                    @include body-text
                    color: var(--color-text)
                    font-weight: 300
        .project-infos
            display: none !important
        > .container
            display: flex
            flex-direction: column
            .project-year
                order: -1
            @include media-breakpoint-down(desktop)
                .hero-text
                    margin-top:  $spacing-3
        @include media-breakpoint-up(desktop)
            margin-bottom: 0
            &.hero--with-image, .content
                padding-top: 0
                figure
                    margin-top: 0
            .container
                padding: 0
            .project-year
                margin-top: $spacing-5
            .hero-text
                @include container
                padding-left: calc(#{offset(2)} + var(--grid-gutter))
                hgroup
                    flex-direction: column
                    width: columns(7)
                h1
                    display: flex
                    align-items: baseline
                    span
                        position: absolute
                        right: var(--grid-gutter)
                    + p
                        margin-top: $spacing-2 !important
                .taxonomies-single
                    margin: 0
            figure
                order: -1
                width: 100%
                img
                    height: $hero-project-image-height
                figcaption
                    padding-left: var(--grid-gutter)
                    padding-right: var(--grid-gutter)
                    &::before
                        right: var(--grid-gutter)
            &:not(.hero--with-image)
                .project-year
                    @include container
                    time
                        margin-left: offset(2)
                .hero-text
                    margin-top: $spacing-3
            &.hero--with-image
                .project-year
                    left: 0
                    padding-left: var(--grid-gutter)
                    padding-right: var(--grid-gutter)
                    position: absolute
                    top: $hero-project-image-height
    .document-content
        .project-sidebar
            display: none
        .block-siblings-navigation
            display: none
    // others projects block
    .blocks .block
        &.block-projects--grid
            border-top: 1px dashed var(--color-text-alt)
            padding-top: $spacing-4
            .block-title
                @include h2
                text-align: center
                a::after
                    opacity: 0
                a:hover::after
                    opacity: 1
            @include media-breakpoint-up(desktop)
                margin-top: space(33)
                padding-top: space(37)
                .block-content
                    padding-right: 0
                    padding-left: 0
    @include media-breakpoint-up(desktop)
        html:not(.has-menu-opened) &
            #document-header:not(.sticky)
                background-color: $header-sticky-background
                figure
                    top: unset
                .logo
                    img
                        display: none
                    + figcaption
                        display: block
                        border: 0 !important
                        clip: unset !important
                        clip-path: unset !important
                        height: auto !important
                        overflow: unset !important
                        padding: unset !important
                        margin: unset !important
                        position: static !important
                        width: unset !important
                        white-space: unset !important
// global
.block-projects--grid,
.projects
    .projects--grid
        @include grid(3, desktop)
        grid-gap: $spacing-5 var(--grid-gutter) !important
        .project-content
            .project-title
                @include h4
                color: $color-text
            .project-subtitle
                @include meta
                color: $color-text
            .project-meta
                time
                    color: $color-text
        .media
            img
                aspect-ratio: 1.36/1
                object-fit: cover

// projects categories
.projects_categories__term
    .hero
        .projects-categories
            margin-left: auto
            margin-right: auto
            margin-top: $spacing-2
            margin-bottom: $spacing-5
            @include media-breakpoint-up(desktop)
                justify-content: center
                width: columns(10)
        @include media-breakpoint-down(desktop)
            .hero-text
                margin-bottom: $spacing-2
                text-align: center
    // taxonomy 'fiche technique'
    &.ancestor-taxonomy
        .projects
            .project
                &-title
                    @include h3
                &-subtitle
                    margin-top: $spacing-2
                &-categories
                    display: flex
                    row-gap: $spacing-1
                    margin-top: $spacing-3
                    li
                        &.ancestor-taxonomy, &.ancestor-chapters
                            order: -1
                        a
                            @extend .btn
                            @extend .button--small
                            @extend .button--accent
                            --btn-min-width: 0
                            padding-bottom: 0
                            padding-top: 0
            @include media-breakpoint-up(desktop)
                .projects--grid
                    display: block
                .project, .project-content
                    flex-direction: row
                    gap: var(--grid-gutter)
                .project
                    .project-content
                        flex: 1
                        position: relative
                    .project-categories
                        position: static
                        max-width: columns(6)
                    .media
                        width: columns(3)

// 'à propos' / 'about' page
.page-about
    .toc-container
        @extend .sr-only
    &:not(.full-width)
        .block-organizations
            border-top: 1px dotted $color-text
            padding-top: $spacing-6
            .block-content
                padding-left: 0 !important
                padding-right: 0 !important
            .organizations.grid
                @include grid(6, desktop)
        @include media-breakpoint-up(desktop)
            .block-title--classic + .block-title--collapsed
                margin-top: space(16)
    .block.block-title--classic h2
        @include h3